## Гравитация и прыжки

Теперь ты сделаешь так, чтобы твой персонаж мог двигаться более реалистично: добавишь гравитацию и дашь персонажу возможность прыгать.

--- task ---

Перемести своего персонажа так, чтобы он сходил с платформы. Видишь, что он идет по пустому пространству?

![снимок экрана](images/dodge-no-gravity.png)

--- /task ---

--- task ---

Чтобы это исправить, добавь гравитацию в игру. Создай новую переменную с именем `гравитация`{:class="block3variables"}.

[[[generic-scratch3-add-variable]]]

Ты можешь скрыть эту переменную со Сцены.

![снимок экрана](images/dodge-gravity-annotated.png)

--- /task ---

--- task ---

Добавь эти новые блоки кода, которые задают отрицательное число `гравитации` и с помощью значения `гравитации` многократно меняй y-координату своего персонажа:

![спрайт Пико ходит](images/pico_walking_sprite.png)

```blocks3
    when flag clicked
	set [гравитации v] to [-4]
	forever
		change y by (гравитации)
	end
```

--- /task ---

--- task ---

Нажми на флаг, а затем перетащи своего персонажа на вершину Сцены. Что происходит? Гравитация работает так, как ты ожидал?

![снимок экрана](images/dodge-gravity-drag.png)

--- /task ---

--- task ---

Гравитация не должна перемещать спрайт персонажа на платформе или лестнице! Добавь блок `если`{:class="block3control"} в свой код, чтобы гравитация работала только тогда, когда персонаж находится в воздухе. Код гравитации должен выглядеть следующим образом:

![спрайт Пико ходит](images/pico_walking_sprite.png)

```blocks3
    when flag clicked
    set [гравитации v] to [-4]
    forever
        if < not < <touching color [#0000FF]?> or <touching color [#FF69B4]?> > > then
            change y by (гравитации)
        end
    end
```

--- /task ---

--- task ---

Проверь игру еще раз, чтобы увидеть, работает ли гравитация правильно. Спрайт персонажа перестает падать, когда он касается платформы или лестницы? Можно ли заставить персонаж сойти с края платформы и упасть на уровень ниже?

![снимок экрана](images/dodge-gravity-test.png)

--- /task ---

--- task ---

Теперь добавь код, чтобы твой персонаж прыгал каждый раз, когда игрок нажимает <kbd>пробел</kbd>. Очень простой способ сделать это - передвинуть своего персонажа вверх несколько раз:

![спрайт Пико ходит](images/pico_walking_sprite.png)

```blocks3
    when [space v] key pressed
    repeat (10)
        change y by (4)
    end
```

Поскольку гравитация постоянно передвигает твоего персонажа вниз на 4 пикселя, тебе нужно выбрать число больше, чем `4` в блоке `изменить y на (4)`{:class="block3motion"}. Измени число так, чтобы тебя устраивала высота прыжка персонажа.

--- /task ---

--- task ---

Проверь свой код. Обрати внимание, что движение прыжка не очень плавное. Чтобы прыжки выглядели более плавными, нужно перемещать персонаж спрайта на всё меньшее и меньшее расстояние до тех пор, пока он уже не поднимается выше.

--- /task ---

--- task ---

Для этого создайте новую переменную с именем `высота прыжка`{:class="block3variables"}. Опять же, ты можешь скрыть эту переменную, если хочешь.

--- /task ---

--- task ---

Удали код прыжка, который ты добавил к своему спрайту персонажа, и вместо этого добавь этот код:

![спрайт Пико ходит](images/pico_walking_sprite.png)

```blocks3
    when [space v] key pressed
    set [высота прыжка v] to [8]
    repeat until < (высота прыжка) = [0] >
        change y by (высота прыжка)
        change [высота прыжка v] by (-0.5)
    end
```

Этот код перемещает твой персонаж на 8 пикселей, затем на 7,5 пикселей, затем на 7 пикселей, и так далее, пока он не поднимется выше. Это делает прыжки более плавными.

--- /task ---

--- task ---

Измени значение переменной `высота прыжка`{:class="block3variables"}, которая задается перед `повторять`{:class="block3control"}. Затем протестируй игру.

Повтори эти два шага, пока тебя не будет устраивать высота прыжка персонажа.

--- /task ---