## 重力とジャンプ

次に、キャラクターをよりリアルに動かします: ゲームに重力を加えて、キャラクターにジャンプする能力を与えます。

--- task ---

ゲーム内でキャラクターを動かして、床から離れるようにします。 なにもない空間に足を踏み入れることができると思いますか？

![スクリーンショット](images/dodge-no-gravity.png)

--- /task ---

--- task ---

これを修正するには、ゲームに重力を追加します。 これを行うには、`重力`{:class="block3variables"}という新しい変数を作成します。

[[[generic-scratch3-add-variable]]]

必要に応じて、この変数をステージから非表示にできます。

![スクリーンショット](images/dodge-gravity-annotated.png)

--- /task ---

--- task ---

`重力`にマイナスの値にし、この`重力`の値を使ってキャラクターのy座標を繰り返し変更する新しいコードブロックを追加します:

![ピコウォーキングスプライト](images/pico_walking_sprite.png)

```blocks3
    ⚑ が押されたとき
[重力 v] を [-4] にする
ずっと 
  y座標を (重力) ずつ変える
end
```

--- /task ---

--- task ---

フラグをクリックし、キャラクターをステージの上部にドラッグします。 何が起こった？ 重力は期待どおりに機能しますか？

![スクリーンショット](images/dodge-gravity-drag.png)

--- /task ---

--- task ---

重力は、キャラクタースプライトを床やはしごの中では動かしてはいけません！ `もし`{:class="block3control"}ブロックをコードに追加し、キャラクターが空中にあるときにのみ重力が機能するようにします。 重力コードは次のようになります。

![ピコウォーキングスプライト](images/pico_walking_sprite.png)

```blocks3
    ⚑ が押されたとき
[重力 v] を [-4] にする
ずっと 
  もし <<<touching color [#0000FF]?> または <touching color [#FF69B4]?>> ではない> なら 
    y座標を (重力) ずつ変える
  end
end
```

--- /task ---

--- task ---

ゲームをもう一度テストして、重力が正しく機能するかどうかを確認してください。 キャラクタースプライトが床またははしごに触れると、落下しなくなりますか？ キャラクターを床の端から歩いて落とし、下のレベルに落とすことができますか？

![スクリーンショット](images/dodge-gravity-test.png)

--- /task ---

--- task ---

プレーヤーが<kbd>スペース</kbd>キーを押すたびにキャラクターをジャンプさせるコードを追加します これを行う非常に簡単な方法の1つは、キャラクターを数回上に移動することです。

![ピコウォーキングスプライト](images/pico_walking_sprite.png)

```blocks3
    [スペース v] キーが押されたとき
(10) 回繰り返す 
  y座標を (4) ずつ変える
end
```

重力がキャラクターを常に4ピクセル押し下げているため、y座標で`(4) ずつ変わる`{:class="block3motion"} ブロックの中で、`4`より大きい数を選択する必要があります 。 キャラクターがジャンプする高さに満足するまで数を変更します。

--- /task ---

--- task ---

コードをテストしましょう。 ジャンプの動きがあまり滑らかではないことに注意してください。 ジャンプをより滑らかに見せるためには、キャラクタースプライトを少しずつ小さな数で動かして、高くならないようにする必要があります。

--- /task ---

--- task ---

これを行うには、`ジャンプの高さ`{:class="block3variables"}という新しい変数を作成します。 繰り返しますが、必要に応じてこの変数を非表示にできます。

--- /task ---

--- task ---

キャラクタースプライトに追加したジャンプコードを削除し、代わりにこのコードを追加します。

![ピコウォーキングスプライト](images/pico_walking_sprite.png)

```blocks3
    [スペース v] キーが押されたとき
[jump height v] を [8] にする
<(ジャンプの高さ) = [0]> まで繰り返す 
  y座標を (ジャンプの高さ) ずつ変える
  [ジャンプの高さ v] を (-0.5) ずつ変える
end
```

このコードは、キャラクターを8ピクセルずつ上に移動し、7.5ピクセル、次に7ピクセル、というように、それ以上高くならなくなるまで行います。 これにより、ジャンプがより滑らかになります。

--- /task ---

--- task ---

`繰り返し`{:class="block3control"} のはじまる前にある`ジャンプの高さ`{:class="block3variables"} 変数の値を変更します。 次に、ゲームをテストします。

キャラクターがジャンプする高さに満足するまでこの2つのステップを繰り返します。

--- /task ---